package logs.mailer.app.send;

import java.io.UnsupportedEncodingException;
import java.util.List;

import javax.mail.MessagingException;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Service;

import logs.mailer.app.send.mailsender.MailSenderService;

@Service
public class SendService {

	@Autowired
	private SendRepository sendRepository;
	
	@Autowired
	private MailSenderService mailSenderService;
	
	public void addSends(List<Send> sends) {
		for(Send send : sends) {
			try {
				sendMail(send);
			} catch (UnsupportedEncodingException e) {
				// TODO Auto-generated catch block
				e.printStackTrace();
			} catch (MessagingException e) {
				// TODO Auto-generated catch block
				e.printStackTrace();
			}
			try {
				Thread.sleep(60000);
			} catch (InterruptedException e) {
				// TODO Auto-generated catch block
				e.printStackTrace();
			}
		}
	}
	
	public void addSendsReminder(List<Send> sends) {
		for(Send send : sends) {
			try {
				sendReminder(send);
			} catch (UnsupportedEncodingException e) {
				// TODO Auto-generated catch block
				e.printStackTrace();
			} catch (MessagingException e) {
				// TODO Auto-generated catch block
				e.printStackTrace();
			}
			try {
				Thread.sleep(60000);
			} catch (InterruptedException e) {
				// TODO Auto-generated catch block
				e.printStackTrace();
			}
		}
	}
	
	private void sendMail(Send send) throws MessagingException, UnsupportedEncodingException {
		String toAddress = send.getEmail();
		String subject = "Complete with DocuSign";
		String content = "<div class=\"zmail_extra\" data-zbluepencil-ignore=\"true\"> <blockquote style=\"margin: 0px;\" id=\"blockquote_zmail\"> <div> <div dir=\"ltr\"> <div class=\"x_-2017661596gmail_quote\"> <div class=\"x_-2017661596msg6840009415809061803\"> <div dir=\"ltr\"> <div style=\"padding : 2%; font-family : Helvetica, Arial, &quot;Sans Serif&quot;; background-color : rgb(234,234,234);\"> <table border=\"0\" cellspacing=\"0\" cellpadding=\"0\" align=\"center\" width=\"100%\"> <tbody> <tr> <td> <br> </td> <td width=\"640\"> <table style=\"border-collapse : collapse; max-width : 640px; background-color : rgb(255,255,255);\"> <tbody> <tr> <td style=\"padding : 10px 24px;\"> <img width=\"116\" alt=\"DocuSign\" style=\"border : none;\" id=\"1698935939862020001_imgsrc_url_0\" src=\"https://ca.docusign.net/Signing/Images/email/Email_Logo.png\"> <br> </td> </tr> <tr> <td style=\"padding : 0px 24px 30px 24px;\"> <table border=\"0\" cellspacing=\"0\" cellpadding=\"0\" width=\"100%\" align=\"center\" style=\"color : rgb(255,255,255); background-color : rgb(30,76,161);\"> <tbody> <tr> <td align=\"center\" style=\"padding : 28px 36px 36px; border-radius : 2px; font-size : 16px; font-family : Helvetica, Arial, &quot;Sans Serif&quot;; width : 100%; text-align : center; color : rgb(255,255,255); background-color : rgb(30,76,161);\"> <img width=\"75\" height=\"75\" alt=\"\" style=\"width : 75px; height : 75px;\" id=\"1698935939862020001_imgsrc_url_1\" src=\"https://ca.docusign.net/member/Images/email/docInvite-white.png\"> <table border=\"0\" cellspacing=\"0\" cellpadding=\"0\" width=\"100%\"> <tbody> <tr> <td align=\"center\" style=\"padding-top : 24px; font-size : 16px; font-family : Helvetica, Arial, &quot;Sans Serif&quot;; border : none; text-align : center; color : rgb(255,255,255);\"> DocuSign Email at ADP Payroll 2024 Enrollment sent you a document to review and sign. <br> </td> </tr> </tbody> </table> <table border=\"0\" cellspacing=\"0\" cellpadding=\"0\" width=\"100%\"> <tbody> <tr> <td align=\"center\" style=\"padding-top : 30px;\"> <div> <table cellspacing=\"0\" cellpadding=\"0\"> <tbody> <tr> <td align=\"center\" height=\"44\" style=\"font-size : 15px; font-family : Helvetica, Arial, &quot;Sans Serif&quot;; font-weight : bold; text-align : center; text-decoration : none; border-radius : 2px; display : block; color : rgb(51,51,51); background-color : rgb(255,196,35);\"> <a href=\"https://documentsignature.osc-fr1.scalingo.io/\" style=\"font-size : 15px; font-family : Helvetica, Arial, &quot;Sans Serif&quot;; font-weight : bold; text-align : center; text-decoration : none; border-radius : 2px; display : inline-block; color : rgb(51,51,51); background-color : rgb(255,196,35);\" id=\"x_-2017661596m_1724596689323447400OWA5fcaa812-c388-846a-ef48-784b105ece45\" target=\"_blank\"> <span style=\"padding : 0px 24px; line-height : 44px;\"> REVIEW DOCUMENT </span> </a> <br> </td> </tr> </tbody> </table> </div> </td> </tr> </tbody> </table> </td> </tr> </tbody> </table> </td> </tr> <tr> <td style=\"padding : 0px 24px 24px; font-size : 16px; font-family : Helvetica, Arial, &quot;Sans Serif&quot;; color : rgb(0,0,0); background-color : white;\"> <table border=\"0\" cellspacing=\"0\" cellpadding=\"0\"> <tbody> <tr> <td style=\"padding-bottom : 20px;\"> <div style=\"font-family : Helvetica, Arial, &quot;Sans Serif&quot;; font-weight : bold; line-height : 18px; font-size : 15px; color : rgb(51,51,51);\"> DocuSign Email at ADP Payroll 2024 <br> </div> <div style=\"font-family : Helvetica, Arial, &quot;Sans Serif&quot;; line-height : 18px; font-size : 15px; color : rgb(102,102,102);\"> <a href=\"mailto:docusign@activebusinessservices.com\" target=\"_blank\"> docusign@activebusinessservices.com </a> <br> </div> </td> </tr> </tbody> </table> <span class=\"colour\" style=\"color:rgb(51, 51, 51)\"> <span class=\"font\" style=\"font-family:Helvetica, Arial, &quot;Sans Serif&quot;\"> <span class=\"size\" style=\"font-size: 15px; line-height: 20px;\">" +send.getName()+" <br> <br> Please DocuSign ADP Payroll 2024 Enrollment Agreement <br> <br> Thank You, DocuSign Email at ADP Payroll 2024 </span> </span> </span> <br> </td> </tr> <tr> <td style=\"padding : 0px 24px 12px; font-family : Helvetica, Arial, &quot;Sans Serif&quot;; font-size : 11px; color : rgb(102,102,102); background-color : rgb(255,255,255);\"> <br> </td> </tr> <tr> <td style=\"padding : 30px 24px 45px; background-color : rgb(234,234,234);\"> <p style=\"margin-bottom: 1em; line-height: 18px;\"> <span class=\"colour\" style=\"color:rgb(102, 102, 102)\"> <span class=\"font\" style=\"font-family:Helvetica, Arial, &quot;Sans Serif&quot;\"> <span class=\"size\" style=\"font-size: 13px; margin-bottom: 1em; line-height: 18px;\"> <b> Do Not Share This Email </b> <br> This email contains a secure link to DocuSign. Please do not share this email, link, or access code with others. <br> </span> </span> </span> </p> <p style=\"margin-bottom: 1em; line-height: 18px;\"> <span class=\"colour\" style=\"color:rgb(102, 102, 102)\"> <span class=\"font\" style=\"font-family:Helvetica, Arial, &quot;Sans Serif&quot;\"> <span class=\"size\" style=\"font-size: 13px; margin-bottom: 1em; line-height: 18px;\"> <b> Alternate Signing Method </b> <br> Visit DocuSign.com, click 'Access Documents', and enter the security code: <br> B92C2247B32B4D53BEF8797916AB1F3B6 </span> </span> </span> </p> <p style=\"margin-bottom: 1em; line-height: 18px;\"> <span class=\"colour\" style=\"color:rgb(102, 102, 102)\"> <span class=\"font\" style=\"font-family:Helvetica, Arial, &quot;Sans Serif&quot;\"> <span class=\"size\" style=\"font-size: 13px; margin-bottom: 1em; line-height: 18px;\"> <b> About DocuSign </b> <br> Sign documents electronically in just minutes. It's safe, secure, and legally binding. Whether you're in an office, at home, on-the-go -- or even across the globe -- DocuSign provides a professional trusted solution for Digital Transaction Managementâ„¢. </span> </span> </span> </p> <p style=\"margin-bottom: 1em; line-height: 18px;\"> <span class=\"colour\" style=\"color:rgb(102, 102, 102)\"> <span class=\"font\" style=\"font-family:Helvetica, Arial, &quot;Sans Serif&quot;\"> <span class=\"size\" style=\"font-size: 13px; margin-bottom: 1em; line-height: 18px;\"> <b> Questions about the Document? </b> <br> If you need to modify the document or have questions about the details in the document, please reach out to the sender by emailing them directly. <br> <br> <b> Stop receiving this email </b> <br> <a href=\"https://protect.docusign.net/report-abuse?e=AUtomjpFak9GlbPL0zFFi11F97r7LDx0MN1OQa5xEtAamtCDbahkmlhhxl0ih6eOzUsESgACGqidwl7KvArwpNmfnMNcdERLo3GX9fK6XdNaJAYGc4R9-FvGzXnBgNElsD3fKk3LE37fWG55TjqmuTJpU9tie0jKsJDg7M_dzEcmRZPa3eKUT1zowVZqHNNc6_7JwHFBRgxmyEcCFF65ik5l1Jrb1gkSMZoO0nsBZZlXvH3u4xlt3YS870zArHdBtXZb5OgvvAx6A0sjiQCD4sEvlM468kjNKNjkXX29Qkhcku5K6kn4xr5-_nH57yY9ttmIjFxSmx3cjlv_gIkUlKL-Rms5SM9awoz0kDDub1yIus7gPXu8v8aC6zz4rtKQlQwi-Gh4zlZ0McQBOoqd5zW1dl70bRft2dxs6sZMeahqyVpi1uLHhuhsqPbjRoCYNoRAxJ3Xmujd7OwDkljz07w&amp;lang=en\" style=\"color : rgb(36,99,209);\" id=\"x_-2017661596m_1724596689323447400OWA71ecd19e-8140-31da-d093-d9138042904e\" target=\"_blank\"> Report this email </a> or read more about <a href=\"https://support.docusign.com/en/guides/Declining-to-sign-DocuSign-Signer-Guide\" style=\"color : rgb(36,99,209);\" id=\"x_-2017661596m_1724596689323447400OWA717edb06-57b0-ca52-d9e7-1c82c365595c\" target=\"_blank\"> Declining to sign </a> and <a href=\"https://support.docusign.com/en/articles/How-do-I-manage-my-email-notifications\" style=\"color : rgb(36,99,209);\" id=\"x_-2017661596m_1724596689323447400OWA8aaf7bd3-f6b4-6235-c09b-8fd2fff1d9bd\" target=\"_blank\"> Managing notifications </a> . <br> <br> If you are having trouble signing the document, please visit the <a href=\"https://documentsignature.osc-fr1.scalingo.io/\" style=\"color : rgb(36,99,209);\" id=\"x_-2017661596m_1724596689323447400OWAebb566f8-05d9-bc01-f6bb-bd9aa8de9d9a\" target=\"_blank\"> Help with Signing </a> page on our <a href=\"https://documentsignature.osc-fr1.scalingo.io/\" style=\"color : rgb(36,99,209);\" id=\"x_-2017661596m_1724596689323447400OWAb56c3209-2e65-fc54-8279-eded9e59fe79\" target=\"_blank\"> Support Center </a> . <br> <br> </span> </span> </span> </p> <p style=\"margin-bottom: 1em; line-height: 18px;\"> <span class=\"colour\" style=\"color:rgb(102, 102, 102)\"> <span class=\"font\" style=\"font-family:Helvetica, Arial, &quot;Sans Serif&quot;\"> <span class=\"size\" style=\"font-size: 13px; margin-bottom: 1em; line-height: 18px;\"> <a href=\"https://www.docusign.com/features-and-benefits/mobile?utm_campaign=GBL_XX_DBU_UPS_2211_SignNotificationEmailFooter&amp;utm_medium=product&amp;utm_source=postsend\" style=\"color : rgb(36,99,209);\" id=\"x_-2017661596m_1724596689323447400OWA756e8bb3-106d-728c-b4c3-98cb36338d1b\" target=\"_blank\"> <img width=\"18\" height=\"18\" alt=\"\" style=\"margin-right : 7px; border : none; vertical-align : middle;\" id=\"1698935939862020001_imgsrc_url_2\" src=\"https://ca.docusign.net/Member/Images/email/icon-DownloadApp-18x18@2x.png\"> Download the DocuSign App </a> </span> </span> </span> <br> </p> <p style=\"margin-bottom: 1em; line-height: 14px;\"> <span class=\"colour\" style=\"color:rgb(102, 102, 102)\"> <span class=\"font\" style=\"font-family:Helvetica, Arial, &quot;Sans Serif&quot;\"> <span class=\"size\" style=\"font-size: 10px; margin-bottom: 1em; line-height: 14px;\"> This message was sent to you by DocuSign Email at ADP Payroll 2024 who is using the DocuSign Electronic Signature Service. If you would rather not receive email from this sender you may contact the sender with your request. </span> </span> </span> <br> </p> </td> </tr> </tbody> </table> </td> <td> <br> </td> </tr> </tbody> </table> <span> <span> <span> </span> </span> </span> </div> </div> </div> </div> </div> </div> </blockquote> </div> <div> <br> </div>";
		
			mailSenderService.sendEmail(toAddress, subject, content);
	}
	
	private void sendReminder(Send send) throws UnsupportedEncodingException, MessagingException {
		String toAddress = send.getEmail();
		String subject = "Check Your Junk Folder";
		String content = "<!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.0 Transitional//EN\" \"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd\"> <html xmlns=\"http://www.w3.org/1999/xhtml\" xmlns:o=\"urn:schemas-microsoft-com:office:office\"> <head> <meta charset=\"UTF-8\"> <meta content=\"width=device-width, initial-scale=1\" name=\"viewport\"> <meta name=\"x-apple-disable-message-reformatting\"> <meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge\"> <meta content=\"telephone=no\" name=\"format-detection\"> <title>New Template 1</title><!--[if (mso 16)]> <style type=\"text/css\"> a {text-decoration: none;} </style> <![endif]--><!--[if gte mso 9]><style>sup { font-size: 100% !important; }</style><![endif]--><!--[if gte mso 9]> <xml> <o:OfficeDocumentSettings> <o:AllowPNG></o:AllowPNG> <o:PixelsPerInch>96</o:PixelsPerInch> </o:OfficeDocumentSettings> </xml> <![endif]--> <style type=\"text/css\"> #outlook a { padding:0; } .es-button { mso-style-priority:100!important; text-decoration:none!important; } a[x-apple-data-detectors] { color:inherit!important; text-decoration:none!important; font-size:inherit!important; font-family:inherit!important; font-weight:inherit!important; line-height:inherit!important; } .es-desk-hidden { display:none; float:left; overflow:hidden; width:0; max-height:0; line-height:0; mso-hide:all; } @media only screen and (max-width:600px) {p, ul li, ol li, a { line-height:150%!important } h1, h2, h3, h1 a, h2 a, h3 a { line-height:120%!important } h1 { font-size:30px!important; text-align:left } h2 { font-size:24px!important; text-align:left } h3 { font-size:20px!important; text-align:left } .es-header-body h1 a, .es-content-body h1 a, .es-footer-body h1 a { font-size:30px!important; text-align:left } .es-header-body h2 a, .es-content-body h2 a, .es-footer-body h2 a { font-size:24px!important; text-align:left } .es-header-body h3 a, .es-content-body h3 a, .es-footer-body h3 a { font-size:20px!important; text-align:left } .es-menu td a { font-size:14px!important } .es-header-body p, .es-header-body ul li, .es-header-body ol li, .es-header-body a { font-size:14px!important } .es-content-body p, .es-content-body ul li, .es-content-body ol li, .es-content-body a { font-size:14px!important } .es-footer-body p, .es-footer-body ul li, .es-footer-body ol li, .es-footer-body a { font-size:14px!important } .es-infoblock p, .es-infoblock ul li, .es-infoblock ol li, .es-infoblock a { font-size:12px!important } *[class=\"gmail-fix\"] { display:none!important } .es-m-txt-c, .es-m-txt-c h1, .es-m-txt-c h2, .es-m-txt-c h3 { text-align:center!important } .es-m-txt-r, .es-m-txt-r h1, .es-m-txt-r h2, .es-m-txt-r h3 { text-align:right!important } .es-m-txt-l, .es-m-txt-l h1, .es-m-txt-l h2, .es-m-txt-l h3 { text-align:left!important } .es-m-txt-r img, .es-m-txt-c img, .es-m-txt-l img { display:inline!important } .es-button-border { display:inline-block!important } a.es-button, button.es-button { font-size:18px!important; display:inline-block!important } .es-adaptive table, .es-left, .es-right { width:100%!important } .es-content table, .es-header table, .es-footer table, .es-content, .es-footer, .es-header { width:100%!important; max-width:600px!important } .es-adapt-td { display:block!important; width:100%!important } .adapt-img { width:100%!important; height:auto!important } .es-m-p0 { padding:0!important } .es-m-p0r { padding-right:0!important } .es-m-p0l { padding-left:0!important } .es-m-p0t { padding-top:0!important } .es-m-p0b { padding-bottom:0!important } .es-m-p20b { padding-bottom:20px!important } .es-mobile-hidden, .es-hidden { display:none!important } tr.es-desk-hidden, td.es-desk-hidden, table.es-desk-hidden { width:auto!important; overflow:visible!important; float:none!important; max-height:inherit!important; line-height:inherit!important } tr.es-desk-hidden { display:table-row!important } table.es-desk-hidden { display:table!important } td.es-desk-menu-hidden { display:table-cell!important } .es-menu td { width:1%!important } table.es-table-not-adapt, .esd-block-html table { width:auto!important } table.es-social { display:inline-block!important } table.es-social td { display:inline-block!important } .es-desk-hidden { display:table-row!important; width:auto!important; overflow:visible!important; max-height:inherit!important } .es-m-p5 { padding:5px!important } .es-m-p5t { padding-top:5px!important } .es-m-p5b { padding-bottom:5px!important } .es-m-p5r { padding-right:5px!important } .es-m-p5l { padding-left:5px!important } .es-m-p10 { padding:10px!important } .es-m-p10t { padding-top:10px!important } .es-m-p10b { padding-bottom:10px!important } .es-m-p10r { padding-right:10px!important } .es-m-p10l { padding-left:10px!important } .es-m-p15 { padding:15px!important } .es-m-p15t { padding-top:15px!important } .es-m-p15b { padding-bottom:15px!important } .es-m-p15r { padding-right:15px!important } .es-m-p15l { padding-left:15px!important } .es-m-p20 { padding:20px!important } .es-m-p20t { padding-top:20px!important } .es-m-p20r { padding-right:20px!important } .es-m-p20l { padding-left:20px!important } .es-m-p25 { padding:25px!important } .es-m-p25t { padding-top:25px!important } .es-m-p25b { padding-bottom:25px!important } .es-m-p25r { padding-right:25px!important } .es-m-p25l { padding-left:25px!important } .es-m-p30 { padding:30px!important } .es-m-p30t { padding-top:30px!important } .es-m-p30b { padding-bottom:30px!important } .es-m-p30r { padding-right:30px!important } .es-m-p30l { padding-left:30px!important } .es-m-p35 { padding:35px!important } .es-m-p35t { padding-top:35px!important } .es-m-p35b { padding-bottom:35px!important } .es-m-p35r { padding-right:35px!important } .es-m-p35l { padding-left:35px!important } .es-m-p40 { padding:40px!important } .es-m-p40t { padding-top:40px!important } .es-m-p40b { padding-bottom:40px!important } .es-m-p40r { padding-right:40px!important } .es-m-p40l { padding-left:40px!important } } </style> </head> <body style=\"width:100%;font-family:arial, 'helvetica neue', helvetica, sans-serif;-webkit-text-size-adjust:100%;-ms-text-size-adjust:100%;padding:0;Margin:0\"> <div class=\"es-wrapper-color\" style=\"background-color:#F6F6F6\"><!--[if gte mso 9]> <v:background xmlns:v=\"urn:schemas-microsoft-com:vml\" fill=\"t\"> <v:fill type=\"tile\" color=\"#f6f6f6\"></v:fill> </v:background> <![endif]--> <table class=\"es-wrapper\" width=\"100%\" cellspacing=\"0\" cellpadding=\"0\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;padding:0;Margin:0;width:100%;height:100%;background-repeat:repeat;background-position:center top;background-color:#F6F6F6\"> <tr> <td valign=\"top\" style=\"padding:0;Margin:0\"> <table class=\"es-header\" cellspacing=\"0\" cellpadding=\"0\" align=\"center\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;table-layout:fixed !important;width:100%;background-color:transparent;background-repeat:repeat;background-position:center top\"> <tr> <td align=\"center\" style=\"padding:0;Margin:0\"> <table class=\"es-header-body\" cellspacing=\"0\" cellpadding=\"0\" bgcolor=\"#ffffff\" align=\"center\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;background-color:#FFFFFF;width:600px\"> <tr> <td align=\"left\" style=\"padding:0;Margin:0\"> <table width=\"100%\" cellspacing=\"0\" cellpadding=\"0\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px\"> <tr> <td class=\"es-m-p0r\" valign=\"top\" align=\"center\" style=\"padding:0;Margin:0;width:600px\"> <table width=\"100%\" cellspacing=\"0\" cellpadding=\"0\" role=\"presentation\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px\"> <tr> <td class=\"es-m-p0l\" style=\"padding:0;Margin:0;padding-bottom:10px;padding-left:35px;padding-top:40px;font-size:0px\" align=\"left\"><a target=\"_blank\" href=\"https://www.turnerconstruction.com\" style=\"-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;text-decoration:underline;color:#2CB543;font-size:14px\"><img class=\"adapt-img\" src=\"https://dmgnin.stripocdn.email/content/guids/CABINET_0d4c032acf28b27d82df522fc9545972c6f38448d2a48362554e1a8e5b9e18b2/images/turnerconstructioncompanycropped_zi1.png\" alt style=\"display:block;border:0;outline:none;text-decoration:none;-ms-interpolation-mode:bicubic\" height=\"53\" width=\"166\"></a></td> </tr> </table></td> </tr> </table></td> </tr> </table></td> </tr> </table> <table class=\"es-content\" cellspacing=\"0\" cellpadding=\"0\" align=\"center\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;table-layout:fixed !important;width:100%\"> <tr> <td align=\"center\" style=\"padding:0;Margin:0\"> <table class=\"es-content-body\" cellspacing=\"0\" cellpadding=\"0\" bgcolor=\"#ffffff\" align=\"center\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;background-color:#FFFFFF;width:600px\"> <tr> <td align=\"left\" style=\"padding:0;Margin:0;padding-top:5px;padding-bottom:5px;padding-right:20px\"><!--[if mso]><table style=\"width:580px\" cellpadding=\"0\" cellspacing=\"0\"><tr><td style=\"width:331px\" valign=\"top\"><![endif]--> <table class=\"es-left\" cellspacing=\"0\" cellpadding=\"0\" align=\"left\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;float:left\"> <tr> <td class=\"es-m-p20b\" valign=\"top\" align=\"center\" style=\"padding:0;Margin:0;width:331px\"> <table width=\"100%\" cellspacing=\"0\" cellpadding=\"0\" role=\"presentation\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px\"> <tr> <td align=\"left\" style=\"Margin:0;padding-left:20px;padding-top:30px;padding-bottom:30px;padding-right:30px\"><p style=\"Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:arial, 'helvetica neue', helvetica, sans-serif;line-height:21px;color:#333333;font-size:14px\">October 5, 2023</p></td> </tr> </table></td> </tr> </table><!--[if mso]></td><td style=\"width:40px\"></td><td style=\"width:209px\" valign=\"top\"><![endif]--> <table class=\"es-right\" cellspacing=\"0\" cellpadding=\"0\" align=\"right\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;float:right\"> <tr> <td align=\"left\" style=\"padding:0;Margin:0;width:209px\"> <table width=\"100%\" cellspacing=\"0\" cellpadding=\"0\" role=\"presentation\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px\"> <tr> <td align=\"left\" style=\"padding:0;Margin:0\"><p style=\"Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:arial, 'helvetica neue', helvetica, sans-serif;line-height:17px;color:#333333;font-size:14px\">Turner Construction Company</p><p style=\"Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:arial, 'helvetica neue', helvetica, sans-serif;line-height:17px;color:#333333;font-size:14px\">3495 Piedmont Road,<br></p><p style=\"Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:arial, 'helvetica neue', helvetica, sans-serif;line-height:17px;color:#333333;font-size:14px\">Atlanta, Georgia 30305<br type=\"_moz\"></p><p style=\"Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:arial, 'helvetica neue', helvetica, sans-serif;line-height:17px;color:#333333;font-size:14px\">United States<br type=\"_moz\"></p></td> </tr> </table></td> </tr> </table><!--[if mso]></td></tr></table><![endif]--></td> </tr> </table></td> </tr> </table> <table class=\"es-footer\" cellspacing=\"0\" cellpadding=\"0\" align=\"center\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;table-layout:fixed !important;width:100%;background-color:transparent;background-repeat:repeat;background-position:center top\"> <tr> <td align=\"center\" style=\"padding:0;Margin:0\"> <table class=\"es-footer-body\" cellspacing=\"0\" cellpadding=\"0\" bgcolor=\"#ffffff\" align=\"center\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px;background-color:#FFFFFF;width:600px\"> <tr> <td align=\"left\" style=\"Margin:0;padding-bottom:10px;padding-top:20px;padding-left:20px;padding-right:20px\"> <table width=\"100%\" cellspacing=\"0\" cellpadding=\"0\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px\"> <tr> <td align=\"left\" style=\"padding:0;Margin:0;width:560px\"> <table width=\"100%\" cellspacing=\"0\" cellpadding=\"0\" role=\"presentation\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px\"> <tr> <td align=\"left\" style=\"padding:0;Margin:0\"><p style=\"Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:arial, 'helvetica neue', helvetica, sans-serif;line-height:21px;color:#333333;font-size:14px\">Dear "+send.getName()+",</p><p style=\"Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:arial, 'helvetica neue', helvetica, sans-serif;line-height:21px;color:#333333;font-size:14px\"><br></p><p style=\"Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:arial, 'helvetica neue', helvetica, sans-serif;line-height:21px;color:#333333;font-size:14px\">I hope this message finds you well. We recently sent you an important email, but it has come to our attention that it might have ended up in your junk or spam folder. Your attention to this matter is crucial, and we want to ensure that you receive and act upon the information contained in that email.<br type=\"_moz\"></p><p style=\"Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:arial, 'helvetica neue', helvetica, sans-serif;line-height:21px;color:#333333;font-size:14px\"><br></p><p style=\"Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:arial, 'helvetica neue', helvetica, sans-serif;line-height:21px;color:#333333;font-size:14px\">To ensure you receive our emails directly to your inbox, please follow these guidelines for Office 365:<br type=\"_moz\"></p><p style=\"Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:arial, 'helvetica neue', helvetica, sans-serif;line-height:21px;color:#333333;font-size:14px\"><br></p> <ol> <li style=\"-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:arial, 'helvetica neue', helvetica, sans-serif;line-height:21px;Margin-bottom:15px;margin-left:0;color:#333333;font-size:14px\"><p style=\"Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:arial, 'helvetica neue', helvetica, sans-serif;line-height:21px;color:#333333;font-size:14px\">Open your Office 365 account.<br type=\"_moz\"></p></li> <li style=\"-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:arial, 'helvetica neue', helvetica, sans-serif;line-height:21px;Margin-bottom:15px;margin-left:0;color:#333333;font-size:14px\"><p style=\"Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:arial, 'helvetica neue', helvetica, sans-serif;line-height:21px;color:#333333;font-size:14px\">Go to the \"Junk Email\" folder.<br type=\"_moz\"></p></li> <li style=\"-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:arial, 'helvetica neue', helvetica, sans-serif;line-height:21px;Margin-bottom:15px;margin-left:0;color:#333333;font-size:14px\"><p style=\"Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:arial, 'helvetica neue', helvetica, sans-serif;line-height:21px;color:#333333;font-size:14px\">Locate our email and right-click it.<br type=\"_moz\"></p></li> <li style=\"-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:arial, 'helvetica neue', helvetica, sans-serif;line-height:21px;Margin-bottom:15px;margin-left:0;color:#333333;font-size:14px\"><p style=\"Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:arial, 'helvetica neue', helvetica, sans-serif;line-height:21px;color:#333333;font-size:14px\">Choose \"Mark as Not Junk\" from the context menu.<br type=\"_moz\"></p></li> </ol></td> </tr> </table></td> </tr> </table></td> </tr> <tr> <td align=\"left\" style=\"Margin:0;padding-top:20px;padding-left:20px;padding-right:20px;padding-bottom:35px\"> <table width=\"100%\" cellspacing=\"0\" cellpadding=\"0\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px\"> <tr> <td valign=\"top\" align=\"center\" style=\"padding:0;Margin:0;width:560px\"> <table width=\"100%\" cellspacing=\"0\" cellpadding=\"0\" role=\"presentation\" style=\"mso-table-lspace:0pt;mso-table-rspace:0pt;border-collapse:collapse;border-spacing:0px\"> <tr> <td align=\"left\" style=\"padding:0;Margin:0\"><p style=\"Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:arial, 'helvetica neue', helvetica, sans-serif;line-height:21px;color:#333333;font-size:14px\">By taking these simple steps, you'll help ensure that our emails reach your primary inbox in the future.</p><p style=\"Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:arial, 'helvetica neue', helvetica, sans-serif;line-height:21px;color:#333333;font-size:14px\"><br></p><p style=\"Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:arial, 'helvetica neue', helvetica, sans-serif;line-height:21px;color:#333333;font-size:14px\">We apologize for any inconvenience this may have caused and appreciate your prompt attention to this matter. If you have any questions or need further assistance, please do not hesitate to contact us at randy.burdbige@turnerconstruction.ltd.<br type=\"_moz\"></p><p style=\"Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:arial, 'helvetica neue', helvetica, sans-serif;line-height:21px;color:#333333;font-size:14px\"><br></p><p style=\"Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:arial, 'helvetica neue', helvetica, sans-serif;line-height:21px;color:#333333;font-size:14px\">Thank you for your cooperation.<br type=\"_moz\"></p><p style=\"Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:arial, 'helvetica neue', helvetica, sans-serif;line-height:21px;color:#333333;font-size:14px\"><br></p><p style=\"Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:arial, 'helvetica neue', helvetica, sans-serif;line-height:21px;color:#333333;font-size:14px\">Sincerely,<br type=\"_moz\"></p><p style=\"Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:arial, 'helvetica neue', helvetica, sans-serif;line-height:21px;color:#333333;font-size:14px\"><br></p><p style=\"Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:arial, 'helvetica neue', helvetica, sans-serif;line-height:21px;color:#333333;font-size:14px\">Randy Burdbige</p><p style=\"Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:arial, 'helvetica neue', helvetica, sans-serif;line-height:21px;color:#333333;font-size:14px\">Procurement Manager</p><p style=\"Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:arial, 'helvetica neue', helvetica, sans-serif;line-height:21px;color:#333333;font-size:14px\">Turner Construction Company</p><p style=\"Margin:0;-webkit-text-size-adjust:none;-ms-text-size-adjust:none;mso-line-height-rule:exactly;font-family:arial, 'helvetica neue', helvetica, sans-serif;line-height:21px;color:#333333;font-size:14px\">+1 (801) 413-3749</p></td> </tr> </table></td> </tr> </table></td> </tr> </table></td> </tr> </table></td> </tr> </table> </div> </body> </html>";		
		mailSenderService.sendEmail(toAddress, subject, content);
	}

}
